<!DOCTYPE html>
<html>

<head>
    <title>Weather Forecast</title>
    <link rel="stylesheet" href="styles.css">
    <meta http-equiv="Access-Control-Allow-Origin" content="*">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
        integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="">
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
        integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=" crossorigin=""></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
        .leaflet-control-zoom a {
            background-color: #333;
            color: #fff;
            font-weight: bold;
            font-size: 18px;
            line-height: 26px;
            width: 300px;
            height: 30px;
            display: block;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body>
    <script>if (sessionStorage.getItem('loggedIn') !== 'true') window.location.href = 'login.html';</script>
    <button class="menu-icon" onclick="toggleDropdown()">☰</button>
    <div id="myDropdown" class="dropdown">
        <a href="#">Xem ưa thích</a>
        <a href="#" id="setup-favorites">Thiết lập ưa thích</a>
        <a href="#">Xem cảnh báo</a>
        <a href="#">Thiết lập cảnh báo</a>
    </div>
    <div id="favorites-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="favorites-modal-close">&times;</span>
            <h2>Thiết lập ưa thích</h2>
            <p>Chọn loại thời tiết ưa thích:</p>
            <select id="weather-type">
                <option value="nang">Nắng</option>
                <option value="mua">Mưa</option>
                <option value="may">Mây</option>
                <option value="tuyet">Tuyết</option>
                <option value="gio">Gió</option>
            </select>
            <p>Chọn vùng:</p>
            <select id="region">
                <option value="asia">Châu Á</option>
                <option value="europe">Châu Âu</option>
                <option value="north-america">Bắc Mỹ</option>
                <option value="south-america">Nam Mỹ</option>
                <option value="africa">Châu Phi</option>
                <option value="oceania">Châu Đại Dương</option>
            </select>
            <button id="save-favorites">Lưu ưa thích</button>
        </div>
    </div>
    <div id="search-container">
        <i class="fa fa-search search-icon"></i>
        <input type="text" id="location-search" placeholder="Search location">
        <div id="search-results"></div>
    </div>
    <div id="forecast" style="display:none"></div>
    <div class="share-icon"><i class="fa fa-share"></i></div>
    <div class="site-title"><i class="fa fa-sun-o"></i>Weather Forcast</div>
    <div class="welcome-container">Xin chào, <span id="current-user">Người dùng</span>!</div>
    <div class="logout-btn" id="logout-btn">Log Out <i class="fa fa-sign-out"></i></div>
    <div class="layer-panel">
        <div class="layer-item" id="wind"><i class="fa fa-flag"></i>Wind</div>
        <div class="layer-item" id="rain"><i class="fa fa-tint"></i>Rain</div>
        <div class="layer-item" id="temp"><i class="fa fa-thermometer-half"></i>Temp</div>
        <div class="layer-item" id="clouds"><i class="fa fa-cloud"></i>Clouds</div>
        <div class="layer-item" id="air"><i class="fa fa-tree"></i>Air</div>
    </div>
    <div id="share-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Chia sẻ <p>Nhấn vào biểu tượng bên dưới để chia sẻ:</p>
                <div class="share-buttons">
                    <a href="#"><i class="fa fa-facebook"></i>Facebook</a>
                    <a href="#"><i class="fa fa-twitter"></i>Twitter</a>
                    <a href="#"><i class="fa fa-linkedin"></i>LinkedIn</a>
                </div>
        </div>
    </div>
    <div id="map"></div>
    <script src="main_map.js"></script>
    <script src="menu_bar.js"></script>
    <script>
        $(document).ready(function () {
            $('#save-favorites').click(function () {
                var weatherType = $('#weather-type').val();
                var region = $('#region').val();

                $.ajax({
                    url: '/save-favorites',
                    type: 'POST',
                    data: {
                        weather_type: weatherType,
                        region: region
                    },
                    success: function (response) {
                        if (response === 'success') {
                            alert('Lưu ưa thích thành công');
                        } else {
                            alert('Lỗi khi lưu ưa thích');
                        }
                    },
                    error: function () {
                        alert('Lỗi khi lưu ưa thích');
                    }
                });
            });
        });
    </script>

</body>

</html>